// PNNL Navbar
// Author: Geoff Elliott

nav {
    form {
        .navbar-vertical-align(@input-height-base);
    }
}

#primary-nav,
.PnnlNavBar {
    z-index: @zindex-navbar;
}

.PnnlNavItem {
    display: inline-block;
    vertical-align: top;
    position: relative;
    font-size: @nav-font-size;

    .badge {
        background-color: @ruby;
        color: white;
        border: 1px solid mix(@onyx, @ruby, 15%);
        position: absolute;
        right: @padding-base-horizontal;
        top: 50%;
        margin-top: -10px;
    }
}

//     /***** Colors *****/

//     /* The navbar-color mixin allows developers to define a particular color of navbar that they want for their application.  To save file space those colors should be defined in the application main.less */

//     /* Default color in Bootstrap file is copper */

//     /* Bronze is used for the action bar */
//     &.bronze-nav {
//         .navbar-color(@bronze);
//     }
// }



#primary-nav,
.PnnlNavBar,
footer.pnnl-action-bar,
footer.PnnlActionBar {
    .container,
    .container-fluid {
        padding: 0;
        margin: auto;

        .row {
            margin-left: -@padding-base-horizontal;
            margin-right: -@padding-base-horizontal;

            > ul,
            > [class^=col-] {
                list-style: none;
                margin-bottom: 0;
                text-align: center;

                &:first-child {
                    text-align: left;
                }

                &:last-child {
                    text-align: right;
                }

                &:only-child {
                    text-align: center;
                }
            }
        }
    }

    .dropdown {
        a:link,
        a:visited {
            text-decoration: none;
        }
    }

    .navbar-form .form-group {
        width: 100%;

        input {
            width: 100%;
        }
    }
}

.PnnlNavItem,
.PnnlActionBar, 
.PnnlNavMenu {
    .pnnl-action,
    .PnnlAction {
        padding: 4px @padding-small-horizontal 1px;
        line-height: @line-height-computed * 0.6;

        span[class^='pnnl-icon-'],
        .PnnlIcon {
            font-size: @app-tabs-icon-size-small;
            line-height: @app-tabs-icon-size-small;
        }

        svg.PnnlIcon {
            width: @app-tabs-icon-size-small;
            height: @app-tabs-icon-size-small;
        }
    }
}

.PnnlWebNavItem:not(.dropdown-toggle) > *,
.dropdown > .PnnlWebNavItem {
    /* Override default appearance for <button>, .btn */
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
    border: none;
    background-color: transparent;
    box-shadow: none;
    border-radius: 0;
}
.PnnlNavItem, .PnnlWebNavItem, .PnnlNavMenu {
    > .PnnlAction:not(.active),
    &.dropdown-toggle {
        &:not(.disabled):hover {
            color: @bronze;
            background-color: rgba(255,255,255,0.4);

            small {
                color: @bronze;
            }
        }
    }

    &.open .PnnlAction:not(.active),
    &.open .PnnlWebNavItem:not(.active) {
        color: @bronze;
        background-color: rgba(255,255,255,0.4);

        small {
            color: @bronze;
        }
    }

    .pnnl-action.active,
    .PnnlAction.active {
        // background-color: @bronze;
        // color: white;
        cursor: default;
        box-shadow: none;

        small {
            color: white;
        }

        &:not(.disabled),
        &:not(.disabled):hover {
            color: white !important;
            background-color: @bronze !important;
            cursor: default;
        }

        & + .badge {
            background-color: white;
            border-color: @bronze;
            color: @bronze;
        }
    }

    svg {
        path, rect, circle {
            transition: fill 0.1s ease;

            &[class*=solid] {
                fill: transparent;
            }
            &[class*=outline] {
                fill: currentColor;
            }
        }

        [class*=pnnl-icon][class$=group] {
            path {
                fill: currentColor;
            }
            path[class*=mark] {
                fill: transparent;
            }
            // Some badges the mark is what we want filled
            path[class*=checkmark] {
                fill: currentColor;
            }
        }
    }

    svg.solid {
        path, rect, circle {
            &[class*=outline] {
                fill: transparent;
            }
            &[class*=solid] {
                fill: currentColor;
            }
        }
    }

    svg.outline {
        path, rect, circle {
            &[class*=solid] {
                fill: transparent;
            }
            &[class*=outline] {
                fill: currentColor;
            }
        }
    }

    .PnnlAction.active, .PnnlAction.active:hover {
        svg {
            path, rect, circle {
                &[class*=outline] {
                    fill: transparent;
                }
                &[class*=solid] {
                    fill: currentColor;
                }
            }
        }
    }
}

@media (max-width: @screen-xs-max) {
    li.PnnlNavItem {
        display: block;

        .dropdown-menu {
            background-color: @platinum-30;
            border-bottom: 1px solid @platinum-40;
            max-height: 0;
            display: block;
            overflow: hidden;
            padding: 0;
            border: none;
            box-shadow: none;
            transition: max-height 0.35s ease;
            position: static;
            float: none;
            border-radius: 0;
            margin-top: 0;
        }

        &.open {
            border-bottom-color: transparent;
        }

        &.open .dropdown-menu {
            max-height: 600px;
            transition: max-height 0.35s ease;
        }

        .dropdown-menu > li > a { /* menus from the navbar */
            padding: @padding-base-vertical @padding-base-horizontal;
            padding-left: 58px;
            font-size: @font-size-large;
        }

        .pnnl-action,
        .PnnlAction,
        .PnnlWebNavItem {
            &, &:link, &:visited {
                line-height: 44px;
                border-bottom: 1px solid @platinum-30;
                display: block;
                width: 100%;
                text-align: left;
                padding-left: @padding-base-horizontal + 2;

                &, 
                small {
                    color: @onyx;
                    font-size: @font-size-large;
                }

                &.active, 
                &.active small {
                    background-color: @bronze;
                    color: white;
                }

                span[class^='pnnl-icon-'],
                .PnnlIcon {
                    font-size: @app-tabs-icon-size-small; //@font-size-large * 1.6;
                    margin-right: 12px;
                    vertical-align: middle;
                    position: relative;
                    top: -2px;
                    display: inline-block;
                }

                .caret {
                    position: static;
                    margin-left: 3px;
                }
            }
        }
    }

    #primary-nav,
    .PnnlNavBar {
        position: fixed;
        top: @header-small-height;
        left: 0;
        height: 0;
        right: 0;
        z-index: @zindex-navbar;
        // display: none;
        background-color: rgba(0,0,0,0);
        transition: all 0.35s ease;

        &.open-nav {
            background-color: rgba(0,0,0,0.8);
            // -webkit-backdrop-filter: blur(5px);
            // backdrop-filter: blur(5px);
            transition: all 0.35s ease;
        }

        &.open-nav,
        &.transitioning {
            height: auto;
            bottom: 0;
            // display: block;
        }

        .navbar-form {
            margin-top: 0;
            margin-bottom: 0;

            .form-group {
                padding-left: @padding-base-horizontal;
                padding-right: @padding-base-horizontal;
            }
        }

        #nav-actions {
            border-radius: 0;

            &.collapse.in {
                position: fixed;
                top: @header-small-height;
                left: 0;
                bottom: 0;
                right: 0;
                overflow-y: auto;
                z-index: @zindex-navbar;
            }

            .row {
                background-color: @platinum-10;
                border-bottom: 1px solid @platinum-30;
                box-shadow: 0 6px 12px rgba(0,0,0,.175);

                ul,
                [class^=col-] {
                    text-align: left !important;
                }
            }
        }

        ul:not([class^=col-]) {
            padding: 0 @padding-base-horizontal;
            margin: 0;

            a, button {
                color: @onyx;
                font-size: @font-size-large;
                text-decoration: none;

                &.active {
                    color: white;
                }   
            }
        }
    }
}

footer.pnnl-action-bar,
footer.PnnlActionBar {
    position: fixed;
    right: 0;
    left: 0;
    bottom: 0;
    z-index: @zindex-navbar - 1; // We want the primary navigation to sit on top when expanded on mobile screens
    background-color: @bronze;
    color: white;
    line-height: 0;

    .pnnl-action,
    .PnnlAction  {
        color: white;
        font-size: @font-size-small - 2;
        min-width: 48px;

        small {
            color: @bronze-40;
        }

        &:not(.disabled):hover, &.active:not(.disabled) {
            background-color: rgba(0,0,0,0.1);

            small {
                color: white;
            }
        }

        &.active {
            box-shadow: none;

            &:focus {
                color: white;
                outline: none;
            }
        }

        svg.PnnlIcon {
            display: block;
            margin: 0 auto;
        }
    }
}

@media (min-width: @screen-sm-min) {
    .PnnlWebNavItem {
        display: inline-block;
    }

    .PnnlWebNavItem:not(.dropdown-toggle) > *,
    .dropdown > .PnnlWebNavItem {
        display: inline-block;
        padding: @padding-large-vertical * 1.5 @padding-large-horizontal @padding-large-vertical * 1.6;

        &, &:link, &:visited, &:active {
            text-decoration: none;
            color: @silver;
        }

        &:hover {
            text-decoration: none;
            color: @bronze;
            background-color: rgba(255,255,255,0.3);
            cursor: pointer;
        }

        &.active:not(.disabled) {
            color: @bronze;
            background-image: linear-gradient(to top, @bronze, @bronze 5px, transparent 5px, transparent);

            &:hover {
                background-color: transparent;
                cursor: default;
            }
        }
    }

    .PnnlNavItem,
    li.dropdown {
        display: inline-block;
    }

    .PnnlNavItem,
    li.dropdown,
    footer.PnnlActionBar {

        .badge {
            top: 3px;
            right: 3px;
            font-size: @font-size-small - 1;
            padding: 3px 4px 2px 5px;
            margin-top: 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .pnnl-action,
        .PnnlAction {
            font-size: @font-size-small;
            line-height: @line-height-computed;
            padding: 6px @padding-small-horizontal 1px;
            min-width: @navbar-height;

            span[class^='pnnl-icon-'],
            .PnnlIcon {
                font-size: @app-tabs-icon-size-base;
                line-height: @app-tabs-icon-size-base;
            }

            svg.PnnlIcon {
                width: @app-tabs-icon-size-base;
                height: @app-tabs-icon-size-base;
                display: block;
                bottom: 0;
                margin: auto;
                transform: scale(1); // Override style from regular buttons
            }
        }

        &.dropdown .PnnlAction {

            svg {
                position: relative;
                left: -4px;
            }
            
            .caret {
                margin-left: 15px;
            }
        }
    }


    #primary-nav,
    .PnnlNavBar {
        background-color: @navbar-default-bg;
        background-image: linear-gradient(to top, rgba(0,0,0,0.08), rgba(0,0,0,0.08) 1px, transparent 1px, transparent);

        .container, .container-fluid {
            display: block;
            height: auto !important;

            [class^='col-']:last-child:not(:only-child) {
                :last-child {
                    // Keep menu from disappearing off edge of window
                    .dropdown-menu {
                        left: auto;
                        right: 0;
                    }
                }
            }

            // Targets web navigation, not app navigation
            .row > ul:not([class^=col-]) {
                // padding: 0;
                padding-left: @padding-base-horizontal;
                text-align: left;
            }
        }

        &.navbar-fixed-top {
            .container, .container-fluid {
                border-radius: 0;
            }

            .container-fluid & {
                margin-left: @padding-base-horizontal;
                margin-right: @padding-base-horizontal;

                > *:first-child {
                    margin: 0;
                }
            }
        }
    }

    #primary-nav,
    .PnnlNavBar,
    footer.pnnl-action-bar,
    footer.PnnlActionBar {
        left: 70px;
    }
}
