import React, { Component } from 'react';
import { connect } from 'react-redux';
import { BrowserRouter, Route, Switch } from 'react-router-dom';
import Grid from 'react-bootstrap/es/Grid';
import Header from 'pnnl-react-core/lib/Header';

import Home from './pages/Home';
import About from './pages/About';
import Navigation from './components/core/Navigation';
import { fetchLoggedInUser } from './actions/me';

class App extends Component {
  componentWillMount() {
    const { dispatch } = this.props;
    dispatch(fetchLoggedInUser('self'));
  }

  render() {
    return (
      <BrowserRouter>
        <div className="App">
          <Header
            appLogo={`${process.env.PUBLIC_URL}/images/app_icon.png`}
            appTitle={process.env.REACT_APP_NAME}
            primaryNav={<Navigation user={this.props.me} />}
            hasSearch={false}
          />
          <main>
            <Grid>
              <Switch>
                <Route path="/about" component={About} />
                <Route path="/" component={Home} />
              </Switch>
            </Grid>
          </main>
        </div>
      </BrowserRouter>
    );
  }
}

const mapStateToProps = (state) => {
  const { me } = state;
  return {
    me,
  };
};

export default connect(mapStateToProps, null)(App);
